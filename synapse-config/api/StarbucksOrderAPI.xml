<api name="StarbucksOrderAPI" context="/order"
	xmlns="http://ws.apache.org/ns/synapse" xmlns:sb="http://starbucks.example.org" 
	xmlns:xsd="http://ws.cs.ucsb.edu/xsd" xmlns:ucsb="http://ws.cs.ucsb.edu">
	<resource url-mapping="/" methods="POST">
		<inSequence>
			<property name="STARBUCKS_HOST_NAME" expression="$axis2:SERVICE_PREFIX" />
			<payloadFactory>
				<format>
					<ucsb:addOrder>
						<ucsb:order>
							<xsd:additions>$1</xsd:additions>
							<xsd:name>$2</xsd:name>
						</ucsb:order>
					</ucsb:addOrder>
				</format>
				<args>
					<arg expression="//sb:drink" />
					<arg expression="//sb:additions" />
				</args>
			</payloadFactory>
			<send>
				<endpoint key="ServiceEndpoint" />
			</send>
		</inSequence>
		<outSequence>
			<property name="HTTP_SC" value="201" scope="axis2" />
			<property name="uri.var.orderId" expression="//xsd:orderId" />
			<sequence key="StarbucksOrderInfo" />
			<send />
		</outSequence>
	</resource>
</api>